<article class="book">
  <header>
    <h2 class="text-primary"><%= @book.title %></h2>

    <section>
      <%= render partial: 'movements/take'%>
      <%= render partial: 'movements/return'%>
    </section>

    <aside class="book-cover">
      <%= image_for(@book) %>
    </aside>
  </header>

  <section>
    <header><h4 class="text-primary">Details</h4></header>

    <p>
      <label>Author:</label>
      <%= @book.author %>
    </p>


    <p>
      <label>Description:</label>
      <%= @book.description %>
    </p>

    <p>
      <label>Pages:</label>
      <%= number_with_delimiter(@book.pages) %>
    </p>
    <p>
      <label>Price:</label>
      <%= number_to_currency(@book.price) %>
    </p>
    <p>
      <label>Average Rating:</label>
      <span id="average_review">
      <%= render partial: 'average_stars', locals: { book: @book } %>
      </span>
    </p>
  </section>

  <section>
    <% if @book.movements.present? %>
      <%= render partial: 'shared/movements', locals: { movements: @book.movements } %>
    <% else %>
      <%= render partial: 'shared/no_takers' %>
    <% end %>
  </section>


  <section>
    <header><h4 class="text-primary">Recent Reviews</h4></header>
    <% if @book.recent_reviews.any? %>
        <%= render partial: 'shared/reviews', locals: { reviews: @book.recent_reviews } %>
        <p>
          Read all
          <span id="read_reviews">
          <%= link_to pluralize(@book.reviews.size, 'review'), book_reviews_path(@book) %>
        </span>
        </p>
    <% else %>
        <p>
          <%= render partial: 'shared/no_reviews' %>
        </p>
        <ol id="reviews"></ol>
    <% end %>
  </section>

  <div class="text-center">
    <nav>
      <%= link_to 'Write a Review', new_book_review_path(@book),
                remote: true,
                data: { 'update-target' => 'review_form_container' },
                class: 'btn btn-primary' %>
    </nav>

    <div id="review_form_container"></div>

    <nav id="book-show-buttons">
      <%= link_to 'Edit', edit_book_path(@book), class: 'btn btn-default' %>
      <span class='inline-button-form'>
        <%= button_to "Delete #{@book.title}", @book,
                      method: :delete,
                      data: { confirm: 'Are you sure?' },
                      class: 'btn btn-danger' %>
      </span>
    </nav>
  </div>
</article>
